@using System.Timers
@using Construlink.Data
@using Construlink.Models
@using Construlink
@using Construlink.Data
@using Construlink.Models
@using Construlink.Shared
@using Microsoft.Data.SqlClient
@using Microsoft.EntityFrameworkCore
@inject IDialogService Dialog
@inject IConfiguration _configuration
@inject Utils utils
@inject IWebHostEnvironment Env
@inject IDbContextFactoryService DbContextFactory

<MudDialog Style="width: 450px">
	<DialogContent>

		@if (PATCH is not null && PATCH.Id > 0)
		{
			<MudTextField T="String" Label="Mensagem" Variant="Variant.Outlined" InputType="InputType.Text" FullWidth="true" @bind-Value="PATCH.Mensagem" />
			<MudTextField T="DateTime?" Format="yyyy-MM-dd" Label="Data" InputType="InputType.Date" Variant="Variant.Outlined" FullWidth="false" @bind-Value="PATCH.Data" />
			<MudCheckBox T="bool?" Label="Titulo" @bind-Value="PATCH.IsTitulo"/>

		}

	</DialogContent>
	<DialogActions>
		<MudButton OnClick="Cancel" Class="mt-2">Cancel</MudButton>
		<MudButton Class="botaoGuardar" OnClick="Submit">Ok</MudButton>
	</DialogActions>
</MudDialog>

@code
{
	[CascadingParameter]
	public MudDialogInstance MudDialog { get; set; } = null!;

	[Parameter]
	public PatchNotes PATCH { get; set; }

	private BaseControleContext dbContext = new BaseControleContext();

	public string error = string.Empty;

	protected override void OnInitialized()
	{
		base.OnInitialized();
	}

	private async Task Submit()
	{
		MudDialog.Close(DialogResult.Ok(PATCH));
	}

	private void Cancel() => MudDialog.Cancel();
}
